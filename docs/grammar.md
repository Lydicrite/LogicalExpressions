# Логические выражения — грамматика (EBNF)

Источник приоритетов/ассоциативности: единый реестр `OperatorRegistry` в коде. Таблица ниже отражает текущую конфигурацию и должна быть синхронизирована с ним.

## Терминалы
- `IDENT` — идентификатор переменной: буква, затем буквы/цифры/`_`.
- `CONST` — константа: `0` | `1` (алиасы: `false`→`0`, `true`→`1`).
- Скобки: `(` и `)`.
- Операторы: `~` (NOT), `&` (AND), `|` (OR), `^` (XOR), `=>` (IMPLIES), `<=>` (IFF), `!&` (NAND), `!|` (NOR). Алиасы перечислены в реестре.

### Алиасы операторов и констант
Ниже приведены наиболее часто используемые алиасы, нормализуемые на этапе токенизации (регистронезависимо):

- `~`: `~`, `!`, `NOT`, `¬`, `не`
- `&`: `&`, `AND`, `˄`, `∧`, `&&`, `и`
- `|`: `|`, `OR`, `˅`, `∨`, `||`, `или`
- `^`: `^`, `XOR`, `⊕`
- `=>`: `=>`, `IMPLIES`, `→`, `->`
- `<=>`: `<=>`, `IFF`, `XNOR`, `≡`, `⇔`, `↔`
- `!&`: `!&`, `NAND`, `/`, `⊼`, `↑`
- `!|`: `!|`, `NOR`, `↓`, `⊽`
- Константы: `0`/`false`/`F`/`⊥`/`нет`, `1`/`true`/`T`/`⊤`/`да`

Примечание: нормализация Unicode (NFKC) может быть отключена для повышения производительности через флаг `OperatorRegistryOptions.EnableUnicodeNormalization`.

Токенизатор применяет Unicode-нормализацию `NFKC`. Комбинация `<` с любым алиасом `=>` распознаётся как `<=>`.

## Приоритеты и ассоциативность
- Уровень 5: `~` — префиксный, право-ассоциативный.
- Уровень 4: `&`, `!&` — инфиксные, лево-ассоциативные.
- Уровень 3: `^` — инфиксный, лево-ассоциативный.
- Уровень 2: `|`, `!|` — инфиксные, лево-ассоциативные.
- Уровень 1: `=>` — инфиксный, право-ассоциативный.
- Уровень 0: `<=>` — инфиксный, лево-ассоциативный.

## EBNF
```
Expression   = OrExpr ;

OrExpr       = ImplExpr { ("|" | "!|") ImplExpr } ;
ImplExpr     = XorExpr { "=>" ImplExpr } | XorExpr { "<=>" XorExpr } ;
XorExpr      = AndExpr { "^" AndExpr } ;
AndExpr      = UnaryExpr { ("&" | "!&") UnaryExpr } ;
UnaryExpr    = { "~" } Primary ;
Primary      = IDENT | CONST | "(" Expression ")" ;
```

Примечания:
- Многократный `~` допустим: `~~A`.
- Алиасы операторов и констант нормализуются на этапе токенизации.
- Правила согласованы с реализацией на базе сортировочной станции и Pratt‑parser.

## Стратегии парсинга
- Поддерживаются две стратегии: сортировочная станция (Shunting‑Yard) и Pratt‑парсер.
- Выбор стратегии:
  - Глобально: `LEParser.SetParserStrategy(new ShuntingYardParserStrategy())` или `new PrattParserStrategy()`.
  - Локально: `LEParser.Parse(string, new LEParserOptions { Strategy = ParserStrategy.Pratt })`.

## Диагностика ошибок
- Для неизвестных токенов формируется `LEParseException` с расширенной информацией: диапазон символов, строка/столбец, фрагмент и подсветка.
- При включённых подсказках токенизатор предлагает ближайшие алиасы (по расстоянию Левенштейна).
- Управление подсказками:
  - Локально: `new LEParserOptions { EnableAliasSuggestions = true/false }`.
  - Через реестр: `OperatorRegistryOptions.EnableSuggestions`, `SuggestionMaxDistance`, `SuggestionMaxItems`.